<!DOCTYPE html>
<html lang="en">

<head>
        <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guía de autoconsumo solar</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;700&display=swap" onload="this.rel='stylesheet'" >
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="preload" as="style" href="../assets/css/global.css" onload="this.rel='stylesheet'" />
    <link rel="preload" as="style" href="../assets/css/guide.css" onload="this.rel='stylesheet'" />
    <script src="../assets/js/scripts.js" defer></script>
    <script src="../assets/js/form.js" defer></script>
    <script src="../assets/js/send-simple.js" defer></script>
    <script src="../assets/js/alpine.min.js" defer></script>
    <meta name="description" content="Cómo puedo hacer autoconsumo solar" />
</head>

<body class="page-descarga" x-data="{
    screen: 'landingpage'
}">
        <menu id="topmenu">
        <div class="title">Guía de autoconsumo solar</div>
        <div class="logo"><img src="../assets/img/greenpeace.svg" alt="Greenpeace" width="184" height="29" /></div>
        <div class="hamburger"><a href="javascript:void(0);" onclick="enter('#sidemenu', 'slideInLeft');"><img src="../assets/img/hamburger.svg" width="37" height="26" alt="Hamburger" /></a></div>
        <div class="autoconsumo"><a href="../">¿Cómo hacer autoconsumo solar?</a></div>
        <div class="calculadora"><a href="../calculadora-de-ahorro/">Calculadora de ahorro</a></div>
        <div class="descarga"><a href="./">Descarga tu guía</a></div>
    </menu>
    <menu id="sidemenu" hidden="hidden" class="animate__faster">
        
        <div id="insidemenu">
            <div class="topinside">
                <div class="title2">Guía de autoconsumo solar</div>
                <div class="logo2"><img src="../assets/img/greenpeace.svg" alt="Greenpeace" width="184" height="29" /></div>
                <div class="menulinks">
                    <div><a href="../">¿Cómo hacer autoconsumo solar?</a></div>
                    <div><a href="../calculadora-de-ahorro/">Calculadora de ahorro</a></div>
                    <div><a href="./">Descarga tu guía</a></div>
                </div>
            </div>

            <div class="close2">
                <a href="javascript:void(0);" onclick="leave('#sidemenu', 'slideOutLeft');">
                    <img src="../assets/img/close.svg" alt="Cerrar" width="26" height="26" />
                </a>
            </div>

        </div>
    </menu>

    <div class="download-grid" id="formpage" x-show="screen === 'landingpage'" x-bind:aria-hidden="not(screen === 'landingpage')"  x-transition.opacity.duration.400ms>

        <h1 class="title-guide">Descarga la guía de autoconsumo solar</h1>

        <div class="text">
            <p>¿Tiemblas cada vez que llega la factura de la luz?  ¿Tienes miedo a una nueva crisis energética?  ¿Llevas tiempo preguntándote si eso de ponerse placas para autoproducirse tu propia electricidad renovable podría ser la solución pero no sabes cómo dar el paso?
            </p>
            <p>Autoproducir tu propia energía puede parecer complicado y caro, pero ya es una realidad para millones de familias porque no es ni lo uno ni lo otro.</p>
            <p><strong>¿Sabías que ni siquiera es necesario tener un tejado en propiedad para hacerlo?</strong></p>
        </div>

        <div class="main-image">
            <img src="../assets/img/portada-descargable.svg" width="172" height="227" alt="Portada del descargable" />
        </div>
        
        <div class="cover">
            <p>En Greenpeace hemos elaborado una sencilla y completa guía en la que podrás encontrar la opción que más se ajusta a tus necesidades. Descubre los pasos a seguir para liberarte de los abusivos incrementos de las compañías eléctricas y contribuir a la lucha contra el cambio climático.</p>
        </div>

        <div class="form-container">
            <h2>Rellena el formulario y recibirás la guía GRATIS en tu email.</h2>

                        <script>
                window.last_abtest_variant = "";
            </script>
            <form id="signup" class="form" novalidate x-on:submit.prevent="" x-init="populate_utms()" x-data="{
                values : {
                    utm_medium: '',
                    utm_source: '',
                    utm_campaign: '',
                    utm_content: '',
                    utm_term: '',
                    gclid: '',
                    ip: '',
                    uagent: '',
                    hs_language: 'es',
                    first_name: '',
                    last_name: '',
                    email: '',
                    id_number: '',
                    phone_number: '',
                    privacy: false,
                    is_contact: false,
                },
                show_errors: false,
                errors: { 
                    first_name: '',
                    last_name: '',
                    email: '',
                    id_number: '',
                    phone_number: '',
                    privacy: '',
                    form_sent: ''
                },
                async populate_utms(){
                    const utmValues = await stringParams();
                    this.values.utm_medium = utmValues.utm_medium;
                    this.values.utm_source = utmValues.utm_source;
                    this.values.utm_campaign = utmValues.utm_campaign;
                    this.values.utm_content = utmValues.utm_content;
                    this.values.utm_term = utmValues.utm_term;
                    this.values.gclid = utmValues.gclid;
                }, 
                validate(){
                    this.required('first_name');
                    this.required('last_name');
                    this.is_required_email('email');
                    /* this.is_required_id_number('id_number'); */
                    this.is_required_phone('phone_number');
                    this.is_checked('privacy');
                },
                is_valid(){
                    let valid = true;
                    for ( const i in this.errors ){
                        if ( this.errors[i] != ''){
                            valid = false;
                        }
                    }
                    return valid;
                },
                async submit_form(){
                    this.errors.form_sent = 'Yes';
                    const answer = await sendToHubspot(this.values);
                    if (answer) {
                        screen = 'thankyoupage';
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                },
                async is_new_email(){
                    if ( this.errors.email ==='' ){
                        const rawResponse = await fetch('https://apis.greenpeace.es/email-info/?' + new URLSearchParams({
                            email: this.values.email
                        }));
                        const content = await rawResponse.json();
                        this.values.is_contact = content.is_contact;
                    } else {
                        this.values.is_contact = false;
                        await console.log('Invalid email');
                    }
                },
                required(field_name) {
                    if ( this.values[field_name].trim().length < 2) {
                        this.errors[field_name] = 'Campo obligatorio';
                    } else {
                        this.errors[field_name] = '';
                    }
                },
                is_required_email(field_name) {
                    if ( this.values[field_name].trim().length < 2) {
                        this.errors[field_name] = 'Campo obligatorio';
                    } else if ( !isValidEmail(this.values[field_name] ) ) {
                        this.errors[field_name] = 'Un email válido por favor, ej. nombre@dominio.tld';
                    } else {
                        this.errors[field_name] = '';
                    }
                },
                is_required_phone(field_name) {
                    if ( this.values[field_name].trim().length < 2) {
                        this.errors[field_name] = 'Campo obligatorio';
                    } else if ( this.values[field_name].trim().length >= 1 && !isValidPhone( this.values[field_name] )) {
                        this.errors[field_name] = 'Tu número de teléfono español por favor';
                    } else {
                        this.errors[field_name] = '';
                    }
                },
                /* is_required_id_number(field_name) {
                    if ( this.values[field_name].trim().length < 2) {
                        this.errors[field_name] = 'Campo obligatorio';
                    } else if ( !isValidIdNumber( this.values[field_name]) ){
                        this.errors[field_name] = 'Un DNI o NIE españoles. Por ejemplo 82451384H o X6909535J.';
                    } else {
                        this.errors[field_name] = '';
                    }
                }, */
                is_checked(field_name) {
                    if ( this.values[field_name] === false ) {
                        this.errors[field_name] = 'Falta aceptar la política de privacidad';
                    } else {
                        this.errors[field_name] = '';
                    }
                }
            }">
                <input type="hidden" name="utm_medium" id="utm_medium" x-model="values.utm_medium" />
                <input type="hidden" name="utm_source" id="utm_source" x-model="values.utm_source" />
                <input type="hidden" name="utm_campaign" id="utm_campaign" x-model="values.utm_campaign" />
                <input type="hidden" name="utm_content" id="utm_content" x-model="values.utm_content" />
                <input type="hidden" name="utm_term" id="utm_term" x-model="values.utm_term" />
                <input type="hidden" name="en_txn6" id="gclid" x-model="values.gclid" />
                <input type="hidden" name="en_txn7" id="ip" x-model="values.ip" />
                <input type="hidden" name="en_txn8" id="uagent" x-model="values.uagent" />
                <input type="hidden" name="last_abtest_variant" id="last_abtest_variant" value="" />
                <input type="hidden" name="hs_language" id="hs_language" x-model="values.hs_language" value="es" />
                <div class="form-group">
                    <label for="first_name" class="d-none">Nombre <sup title="Campo obligatório">*</sup></label>
                    <input type="text" class="form-control" id="first_name" name="first_name" required="required" maxlength="40" autocomplete="given-name" x-model="values.first_name" x-on:input="required('first_name'); $store.fname = $el.value" />
                    <div class="error-message" x-text="errors.first_name" x-show="show_errors" x-bind:aria-hidden="not(show_errors)"></div>
                </div>
                <div class="form-group">
                    <label for="last_name" class="d-none">Apellidos <sup title="Campo obligatório">*</sup> </label>
                    <input type="text" class="form-control" id="last_name" name="last_name" required="required" maxlength="40" autocomplete="family-name" x-model="values.last_name" x-on:input="required('last_name')" />
                    <div class="error-message" x-text="errors.last_name" x-show="show_errors" x-bind:aria-hidden="not(show_errors)"></div>
                </div>
                <div class="form-group">
                    <label for="email" class="d-none">Email <sup title="Campo obligatório">*</sup></label>
                    <input type="email" class="form-control" id="email" name="email" required="required" maxlength="50" autocomplete="email" x-model="values.email" x-on:input="is_required_email('email'); $store.email = $el.value" x-on:change="is_new_email()"  />
                    <div class="error-message" x-text="errors.email" x-show="show_errors" x-bind:aria-hidden="not(show_errors)"></div>
                </div>
                <!--<div class="form-group">
                    <label for="id_number" class="d-none"> <sup title="Campo obligatório">*</sup> <span class="sr-only"></span></label>
                    <input type="text" class="form-control" id="id_number" name="id_number" required="required" maxlength="12" placeholder="" x-model="values.id_number" x-on:input="is_required_id_number('id_number')" />
                    <div class="error-message" x-text="errors.id_number"  x-show="show_errors" x-bind:aria-hidden="not(show_errors)"></div>
                </div> -->
                <div class="form-group">
                    <label for="phone_number" class="d-none">Teléfono <sup title="Campo obligatório">*</sup> <span class="sr-only">Ej. 623456789</span></label>
                    <input type="tel" class="form-control" id="phone_number" name="phone_number" maxlength="15" autocomplete="tel-national" required="required" x-model="values.phone_number" x-on:input="is_required_phone('phone_number')" />
                    <div class="error-message" x-text="errors.phone_number" x-show="show_errors" x-bind:aria-hidden="not(show_errors)"></div>
                </div>
                <div class="privacynotice" data-nosnippet="true">
                    Quiero recibir información acerca de las campañas de Greenpeace y formas de participación. Al firmar, acepto la política de privacidad. Desde GREENPEACE ESPAÑA trataremos los datos aportados en calidad de Responsable del tratamiento con la finalidad de gestionar nuestra relación contigo, en pro de nuestros objetivos fundacionales, en base al consentimiento o a la ejecución de un acuerdo. Puedes ejercer tus derechos enviando un email a contacto.es@greenpeace.org con el asunto “Protección de Datos”. <a target="_blank" href="https://es.greenpeace.org/es/politica-de-privacidad-y-cookies/" class="privacy_policy_link_form">Más información.</a>
                </div>
                <div class="privacycontainer">
                    <label for="privacy">
                        <input type="checkbox" id="privacy" name="privacy" value="Y" required="required" x-model="values.privacy" x-on:change="is_checked('privacy')" />
                        <span id="iaccept">Acepto la política de privacidad <sup title="Campo obligatório">*</sup></span>
                        <div class="error-message" x-text="errors.privacy"  x-show="show_errors" x-bind:aria-hidden="not(show_errors)"></div>
                    </label>
                </div>
                <div class="buttoncontainer">
                    <button type="submit" class="colored-button" x-on:click="show_errors = true; validate(); is_valid() && submit_form()"> Descarga la guía » </button>	
                </div>
            </form>

        </div>

    </div>

    <div class="thank-you-grid" id="thankyoupage" x-show="screen === 'thankyoupage'" x-bind:aria-hidden="not(screen === 'thankyoupage')" x-transition.duration.300ms>
        <div>
            <h2>Disfruta de tu guía, Olga</h2>
            <p>Ya te hemos enviado la guía a <span x-text="$store.email">[...]</span></p>
            <p>¿Quieres compartirla con tus contactos? ¡Ayúdalos a iniciarse en el autoconsumo solar!</p>
            <div class="line-of-buttons">
                <button type="button" class="colored-button yes" x-on:click="screen = 'sharepage'; $dispatch('thankyou:buttons', { button: 'yes_to_share' });">Si</button>
                <button type="button" class="colored-button" x-on:click="screen = 'givepage'; $dispatch('thankyou:buttons', { button: 'no_to_share' });">No</button>
            </div>
        </div>
    </div>
    <div class="share-grid" id="sharepage" x-show="screen === 'sharepage'" x-bind:aria-hidden="not(screen === 'sharepage')" x-transition.duration.300ms>
        <div>
            <h2>Comparte esta guía</h2>
            <p>Ayuda a otra gente a consumir su propia energía solar.</p>
            <div class="thankyoubuttons">
                <a href="https://api.whatsapp.com/send?text=¿Quieres comer alimentos de temporada pero no se te ocurre cómo cocinarlos? Esta guía incluye un calendario de frutas y verduras de temporada, una receta para cada mes del año y mucho más. ¡Descárgala ya aquí! https://es.greenpeace.org/es/frutas-verduras-temporada/descargar-guia/%3Futm_source%3Dwhatsapp%26utm_medium%3Dsocial_network_link%26utm_campaign%3DFrutadetemporada" target="_blank" x-on:click="$dispatch('thankyou:buttons', { button: 'whatsapp' });" aria-label="Whatsapp">
                    <img src="../assets/img/whatsapp.svg" width="41" height="41" alt="Whatsapp" />
                </a>
                <a href="http://www.facebook.com/sharer.php?u=https://es.greenpeace.org%2Fes%2Ffrutas-verduras-temporada%2Fdescargar-guia%2F" target="_blank" x-on:click="$dispatch('thankyou:buttons', { button: 'facebook' });" aria-label="Facebook">
                    <img src="../assets/img/facebook.svg" width="41" height="41" alt="Facebook" />
                </a>
                <a href="https://twitter.com/intent/tweet?text=¿Quieres comer alimentos de temporada pero no se te ocurre cómo cocinarlos? Esta guía de @greenpeace_esp incluye un calendario de frutas y verduras de temporada, una receta para cada mes del año y mucho más. ¡Descárgala ya aquí! https://es.greenpeace.org/es/frutas-verduras-temporada/descargar-guia/%3Futm_source%3Dtwitter%26utm_medium%3Dsocial_network_link%26utm_campaign%3DFrutadetemporada&amp;source=webclient" target="_blank" x-on:click="$dispatch('thankyou:buttons', { button: 'twitter' });" aria-label="Twitter">
                    <img src="../assets/img/twitter.svg" width="41" height="41" alt="Twitter" />
                </a>
            </div>
            <button type="button" class="colored-button" x-on:click="screen = 'givepage'; $dispatch('thankyou:buttons', { button: 'skip_to_donations' });">Saltar »</button>
        </div>
    </div>
    <div class="support-grid" id="givepage" x-show="screen === 'givepage'" x-bind:aria-hidden="not(screen === 'givepage')" x-transition.duration.300ms>
        <div>
            <h2>Apoya la campaña</h2>
            <p>En Greenpeace trabajamos para proteger nuestros bosques y defender su biodiversidad. Únete ahora y súmate a la lucha por un planeta sano y en paz.</p>
            <div class="line-of-buttons">
                <a href="https://es.greenpeace.org/es/que-puedes-hacer-tu/donaciones/" class="colored-button" x-on:click.prevent="$dispatch('thankyou:buttons', { button: 'yes_to_give' }); await delay(1000); window.location.href = $el.getAttribute('href');">Hazte socio/a</a>
            </div>
        </div>
    </div>

</body>

</html>